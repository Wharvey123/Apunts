# Atacs. Cicle de cinc fases

1: Reconeixement
=======================
Objectiu: Recopilació d'informació sobre el sistema objectiu.

Tècniques:
-----------
- Enginyeria social o trashing per aconseguir informació valuosa.
- Recerques a Internet.
- Capturar trànsit de xarxa (sniffing).
- Ús de l'ordre whois per obtenir dades del sistema.

Recursos: Whois.com, ICANN Whois.

2: Exploració
===================
Objectiu: Sondar el sistema per detectar vulnerabilitats explotables.

Accions:
--------
- Recopilar informació sobre comptes d'usuari, versions de sistemes operatius, aplicacions, i ports oberts.
- Utilització d'escàners de xarxa o de ports com nmap.
- Ordres com tracert (Windows) o traceroute (Linux/Unix) per rastrejar canvis de xarxa.

3: Accés
===============
Objectiu: Explotar vulnerabilitats per accedir al sistema.

Tècniques de Crackeig de Contrasenyes:
---------------------------------------
- Online: Tests en viu amb eines com Hydra.
- Offline: Extracció i anàlisi de contrasenyes encriptades, amb eines com Cain i Abel.

Evasió:
-------
- Evasió de Firewalls, IDS, IPS, i Honeypots.
- Eines: 007 Shell, ICMP Shell, AckCmd.

4: Manteniment de l'Accés
===============================
Objectiu: Preservar l'accés futur al sistema.

Mètodes:
---------
- Instal·lació de malware com cavalls de Troia i rootkits.

Accions:
---------
- Keylogging, captura de trànsit (sniffing), instal·lació de FTP il·lícits.
- Uso de Rootkits a nivells de Kernel, Llibreries, i Aplicacions.

5: Esborrat d'Empremtes
=============================
Objectiu: Ocultar l'activitat maliciosa i evitar detecció.

Pasos:
------
- Desactivar Auditoria del sistema si està activa.
- Eliminar registres (logs) del sistema i aplicacions compromeses.
- Eliminar evidència d'eines utilitzades mitjançant esteganografia.

# **SERVEI DNS**

*Format missatge DNS*: Els missatges DNS segueixen un format específic amb camps com ID, flags, i tipus de consulta o resposta.

*Saber on es dóna la vulnerabilitat i en què consisteix*: Les vulnerabilitats poden presentar-se en diverses àrees, com ara IP Spoofing, DNS Caché Poisoning, DoS, Man in the Middle, DNS tunneling, i DoS DNS amplification attack.

*Transaccions més comuns*:
   - Consultes/respostes.
   - Transferències de zona.
   - Actualitzacions dinàmiques.
   - Notificacions.

*Atacs i funcionament dels mateixos*:
   - IP Spoofing.
   - DNS Caché Poisoning.
   - DoS.
   - Man in the Middle.
   - DNS tunneling.
   - DoS DNS amplification attack.

*Capes servei DNS. Assegurament*:
   - Entorn base.
   - S.O.
   - Software Bind.
   - Topologia de xarxa.
   - Dades.
   - Parametritzacions.
   - Info registres de zona.
   - Transaccions.
   - Queries (Consultes/Respostes).
   - Transferències de zona.
   - Notificacions.
   - Actualitzacions dinàmiques.

*Assegurament del servei DNS*:
   - Contramesures als atacs.
   -  DNSSEC és una extensió de seguretat per al sistema de noms de domini (DNS). L'objectiu principal de DNSSEC és garantir la integritat i autenticitat de la informació del DNS, protegint contra atacs com la           suplantació d'identitat i la modificació de dades.
      - Signatura de Zones
      - Clau Pública i Privada
      - Inclusió de Signatures a la Zona DNS
      - Cadena de Confiança
   - Xifratge DNS (DNS over TLS i DNS over HTTPS). Ports usats: 853/443 (53 UDP).
      - **DNS over TLS (DoT)** és un protocol que utilitza el Transport Layer Security (TLS) per xifrar les comunicacions entre el client DNS i el servidor DNS. Les consultes es realitzen pel port 853, millorant             la privacitat i seguretat del DNS.
      - **DNS over HTTPS (DoH)** utilitza el protocol HTTPS per xifrar les consultes DNS i respostes, integrant-les amb el tràfic HTTPS normal pel port 443. Aquest protocol millora la privacitat i és fàcil                   d'integrar amb HTTPS, facilitant la implementació en navegadors i altres aplicacions.

# **SERVEI FTP**

*Saber on es dóna la vulnerabilitat i en què consisteix*: Les vulnerabilitats poden existir en:
   - Software server no actualitzat.
   - Software server mal configurat.
   - Molts admins.
   - Protocols o xifratge ja vulnerats.
   - Entorn difícil d’administrar.
   - Falta d’alertes o pistes per auditoria (LOGS).

*Atacs*:
   - Per força bruta.
   - Rebot FTP.
   - Robatori de ports.
   - Attack Spoofing.
   - DoS - DDoS.

*Mesures a prendre per assegurar el servei FTP*:
   - Deshabilitar estàndard FTP. Alternatives [FTPS (TLS), SFTP (SSL)].
   - Encriptació i hasos robustos.
   - Instal·lar servidor darrera Gateway.
   - Llistes blanques i llistes negres d’IPs.
   - Assegurar servidor FTPS (Mode explícit, mode implícit, TLS 1.2, Certificats SSL).
   - Gestió administració del compte (Separar credencials, deshabilitar usuari anonym, política de contrasenyes robusta, etc.).

# **SERVEI CORREU ELECTRÒNIC**

*Principals atacs*:
   - Phishing: Atac que utilitza enganys per obtenir informació confidencial, com contrasenyes o detalls de targetes de crèdit, mitjançant missatges falsos o enganyosos que semblen ser de fonts de confiança.
   - Spoofing: Tècnica en què l'atacant falsifica la seva identitat o adreça per semblar provenir d'una font de confiança. En l'àmbit del correu electrònic, pot implicar falsificar l'adreça del remitent per enganyar els destinataris.

*Protocol SPF (Sender Policy Framework*:
   - SPF és un protocol de correu electrònic que ajuda a prevenir el correu no desitjat o falsificant la identitat del remitent.
   - L'administrador del domini especifica les adreces IP autoritzades per enviar correus des del seu domini.
   - Els servidors de correu poden verificar aquesta informació per assegurar-se que el correu ha estat enviat des d'una font legítima.
     
*Protocol DKIM (DomainKeys Identified Mail*:
   - DKIM és un protocol que assegura que el contingut d'un missatge de correu electrònic no ha estat alterat durant el trànsit.
   - El remitent signa digitalment els missatges amb una clau privada, i el receptor verifica la signatura utilitzant la clau pública disponible al registre DNS del domini del remitent.

*Estàndard DMARC (Domain-based Message Authentication, Reporting, and Conformance)*:
   - DMARC és una especificació que afegeix una capa addicional a SPF i DKIM per millorar la autenticació del correu electrònic.
   - Permet als remitents indicar com volen que es tractin els missatges que no superen les verificacions SPF i DKIM.
   - Proporciona informació als remitents sobre els intents d'usurpació de la seva identitat.

*Mesures a prendre*:
   - Contra Phishing:
      - Educació de l'Usuari
      - Filtres Anti-Phishing
      - Verificació de Llocs WebS
      - Autenticació en Dos Passos
   - Contra Spoofing:
      - Autenticació de Correu Electrònic
      - Control d'Accés a Xarxa
      - Monitoratge de Tràfic
      - Encriptació de Comunicacions
      - Actualització de Sistemes
   - Utilitzar xifratge OpenPGP amb clau pública/privada.

# **SERVEI WEB**

*Saber on es dóna la vulnerabilitat i en què consisteix*: Les vulnerabilitats poden existir en:
   - Divulgació WSDL.
   - Bomba XML.
   - Injecció XPath.
   - Injecció XML.

*Arquitectura servei web*:
   - Proveïdor de Serveis (Service Provider): Entitat que ofereix els serveis web.
   - Qui publica (Service Broker): Gestiona la publicació dels serveis i facilita la comunicació entre proveïdors i consumidors.
   - Qui demana el servei (Service Requester): Entitat que sol·licita i utilitza els serveis web.
   - Fitxer WSDL: Descriu la interfície del servei, incloent la informació sobre com interactuar amb ell.
   - Protocol SOAP: Protocol utilitzat per a la comunicació entre els components del servei web.
   - UDDI (Universal Description, Discovery, and Integration): Sistema per a la publicació, descobriment i integració de serveis web.

*Contramesures*:
   - Divulgació WSDL:
      Contramesura: Restringeixi l'accés als documents WSDL només als usuaris autoritzats. Implementa autenticació i autorització per controlar qui pot accedir als WSDL.
   - Bomba XML:
      Contramesura: Limita la mida dels documents XML acceptats pel sistema. Utilitza comprovacions de validesa per garantir que només es processin documents XML vàlids.
   - Injecció XPath i XML:
      Contramesura: Utilitza paràmetres preparats o vinculació de paràmetres en les consultes XPath per prevenir la injecció. Validació estrita dels inputs per assegurar-se que no continguin codi maliciós. Utilitza       mecanismes de filtratge per escapar caràcters especials.

# **SERVEI VoIP**

*En què consisteix*:
   - VoIP és una tecnologia que transmet veu i comunicació a través d'Internet en lloc de xarxes de telefonia convencional. Converteix la veu en dades digitals per a trucades, videoconferències i missatgeria en         temps real, utilitzant protocols com RTP i SIP.

*Avantatges*:
   - Costs Reduïts: VoIP sovint és més econòmic en comparació amb les tarifes tradicionals de telefonia.
   - Funcionalitats Avançades: Ofereix funcionalitats com videoconferències, missatgeria instantània i transferència de fitxers.
   - Mobilitat: Permet fer trucades des de qualsevol lloc amb accés a Internet.
   - Flexibilitat: Suporta diverses formes de comunicació a través d'una única plataforma.
*Inconvenients*:
   - Dependència d'Internet: La qualitat pot veure's afectada per la connexió a Internet, especialment en zones amb baixa banda ampla.
   - Alimentació Elèctrica: En cas de fallada d'energia, els serveis VoIP poden veure's afectats.
   - Qualitat de Servei (QoS): La qualitat pot ser variable i depèn de diversos factors com la latència i la congestió de la xarxa.
   - Seguretat: Pot ser vulnerable a atacs cibernètics i interceptació de trucades, tot i que mesures com l'ús de xifratge poden mitigar aquests problemes.

*Elements que hi participen*:
   - Terminals: Dispositius utilitzats per a la comunicació VoIP, com telèfons IP, auriculars i aplicacions de softphone.
   - Gateways: Dispositius que converteixen trucades VoIP en formats compatibles amb xarxes de telefonia tradicional i viceversa.
   - Gatekeepers: Components que gestionen i controlen les trucades en xarxes VoIP, especialment en entorns utilitzant el protocol H.323.
   - Protocol RTP i RTCP: RTP (Real-Time Transport Protocol) és utilitzat per a la transmissió en temps real de veu i vídeo, mentre que RTCP (Real-Time Control Protocol) proporciona informació de control i              monitoratge.
   - Protocol H323: Estàndard per a trucades de veu, vídeo i dades sobre xarxes de paquets, utilitzat principalment en sistemes basats en IP.
   - Protocol SIP: Protocol de senyalització per a la iniciació, modificació i finalització de sessions multimèdia, com trucades VoIP i videoconferències.
   - Tipus de Servidors: Incloïxen servidors de registre (per emmagatzemar ubicacions d'usuaris), servidors de proxy (per encaminar trucades) i servidors de presència (per indicar l'estat dels usuaris).

*Vulnerabilitats i atacs*:
   - Accessos desautoritzats i fraus.
   - Vulnerabilitats de la xarxa subjacent: Aprofitar debilitats en la xarxa per accedir o interrompre el servei VoIP.
   - Atacs de denegació de servei.
   - Atacs als dispositius.
   - Enumeració i descobriment.
   - Atacs a nivell d'aplicació.
   - Autenticació en VoIP.
   - Manipulació senyalització.
   - Suplantació identitat.
   - Desregistrar usuaris.
   - Desconnexió usuaris.
   - Redirecció trucades.
   - Manipulació transmissió.
   - Eavesdropping.
   - Inserció àudio: Afegir contingut de veu no autoritzat en les trucades.
   - Fuzzing: Provar sistemes VoIP amb dades no vàlides o aleatòries per detectar vulnerabilitats.
   - DoS.

*Assegurament del servei VoIP*:
   - TLS (Transport Layer Security): Implementar xifratge de capa de transport per protegir les comunicacions VoIP.
   - VPNs (Virtual Private Networks): Utilitzar xarxes privades virtuals per afegir una capa addicional de seguretat a les trucades VoIP.
   - Protocol SRTP (Secure Real-Time Transport Protocol): Emprar aquest protocol per a la seguretat en la transmissió en temps real de veu i vídeo.
   - VLANs (Virtual LANs): Segmentar la xarxa mitjançant VLANs per separar el tràfic VoIP i millorar la seguretat.
   - Limitar Accés a la Xarxa VoIP: Controlar l'accés als dispositius i recursos VoIP per evitar usuaris no autoritzats.
   - Limitar Volum de Dades:
   - Establir límits en el volum de dades per prevenir atacs de saturació o sobrecàrrega.
